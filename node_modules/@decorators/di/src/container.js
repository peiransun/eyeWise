"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const store_1 = require("./store");
const errors_1 = require("./errors");
class Container {
    /**
     * Register new or replace providers
     *
     * @static
     * @param {Provider[]} providers
     */
    static provide(providers) {
        providers
            .filter((_provider) => _provider.useClass)
            .forEach((_provider) => this.registerClassProvider(_provider));
        providers
            .filter((_provider) => _provider.useFactory)
            .forEach((_provider) => this.registerFactoryProvider(_provider));
        providers
            .filter((_provider) => _provider.useValue)
            .forEach((_provider) => this.registerValueProvider(_provider));
    }
    /**
     * Get instance of injectable
     *
     * @template T
     * @param {Injectable} injectable
     * @returns {T}
     */
    static get(injectable) {
        const provider = store_1.Store.findProvider(injectable);
        if (provider === undefined) {
            throw new errors_1.MissingProviderError(injectable);
        }
        return this.resolveProvider(provider);
    }
    /**
     * Resolve provider
     *
     * @private
     * @param {StoreProvider} provider
     * @param {StoreProvider[]} [requesters = []] provider, that initiated di
     * @returns {*}
     */
    static resolveProvider(provider, requesters = []) {
        if (provider.value) {
            return provider.value;
        }
        requesters.push(provider);
        const deps = provider
            .deps.map((dep) => {
            const requesterProvider = requesters.find((requester) => requester.id === dep.id);
            if (requesterProvider) {
                throw new errors_1.RecursiveProviderError(requesters, requesterProvider);
            }
            const depService = store_1.Store.findProvider(dep.id);
            if (!depService && !dep.optional) {
                throw new errors_1.MissingProviderError(provider, dep);
            }
            if (!depService && dep.optional) {
                return null;
            }
            return this.resolveProvider(depService, requesters);
        });
        provider.value = provider.factory ?
            provider.factory(...deps) : new provider.type(...deps);
        return provider.value;
    }
    /**
     * Register class provider
     *
     * @private
     * @static
     * @param {ClassProvider} provider
     */
    static registerClassProvider(provider) {
        const id = store_1.Store.providerId(provider.provide);
        const classProvider = store_1.Store.findProvider(provider.useClass);
        const deps = classProvider ? classProvider.deps : (provider.deps || [])
            .map((dep) => ({ id: store_1.Store.providerId(dep) }));
        store_1.Store.replaceProvider(provider.provide, { id, deps, type: provider.useClass });
    }
    /**
     * Register factory provider
     *
     * @private
     * @static
     * @param {FactoryProvider} provider
     */
    static registerFactoryProvider(provider) {
        const id = store_1.Store.providerId(provider.provide);
        const factory = provider.useFactory;
        const deps = (provider.deps || [])
            .map((dep) => ({ id: store_1.Store.providerId(dep) }));
        store_1.Store.replaceProvider(provider.provide, { id, factory, deps });
    }
    /**
     * Register value provider
     *
     * @private
     * @static
     * @param {ValueProvider} provider
     * @memberof Container
     */
    static registerValueProvider(provider) {
        const id = store_1.Store.providerId(provider.provide);
        const value = provider.useValue;
        store_1.Store.replaceProvider(provider.provide, { id, value });
    }
}
exports.Container = Container;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGFpbmVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY29udGFpbmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBV0EsbUNBQWdDO0FBQ2hDLHFDQUF3RTtBQUV4RTtJQUVFOzs7OztPQUtHO0lBQ0ksTUFBTSxDQUFDLE9BQU8sQ0FBQyxTQUFxQjtRQUN6QyxTQUFTO2FBQ04sTUFBTSxDQUFDLENBQUMsU0FBd0IsRUFBRSxFQUFFLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQzthQUN4RCxPQUFPLENBQUMsQ0FBQyxTQUF3QixFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztRQUVoRixTQUFTO2FBQ04sTUFBTSxDQUFDLENBQUMsU0FBMEIsRUFBRSxFQUFFLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQzthQUM1RCxPQUFPLENBQUMsQ0FBQyxTQUEwQixFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsdUJBQXVCLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztRQUVwRixTQUFTO2FBQ04sTUFBTSxDQUFDLENBQUMsU0FBd0IsRUFBRSxFQUFFLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQzthQUN4RCxPQUFPLENBQUMsQ0FBQyxTQUF3QixFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztJQUNsRixDQUFDO0lBRUQ7Ozs7OztPQU1HO0lBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBSSxVQUFzQjtRQUN6QyxNQUFNLFFBQVEsR0FBa0IsYUFBSyxDQUFDLFlBQVksQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUUvRCxFQUFFLENBQUMsQ0FBQyxRQUFRLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQztZQUMzQixNQUFNLElBQUksNkJBQW9CLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDN0MsQ0FBQztRQUVELE1BQU0sQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFD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SSxHQUFpQixDQUFDLFFBQVEsQ0FBQyxJQUFJLElBQUksRUFBRSxDQUFDO2FBQzdDLEdBQUcsQ0FBQyxDQUFDLEdBQWUsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxhQUFLLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBRTdELGFBQUssQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLE9BQU8sRUFBRSxFQUFFLEVBQUUsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQTtJQUNoRSxDQUFDO0lBRUQ7Ozs7Ozs7T0FPRztJQUNLLE1BQU0sQ0FBQyxxQkFBcUIsQ0FBQyxRQUF1QjtRQUMxRCxNQUFNLEVBQUUsR0FBaUIsYUFBSyxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDNUQsTUFBTSxLQUFLLEdBQVEsUUFBUSxDQUFDLFFBQVEsQ0FBQztRQUVyQyxhQUFLLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxPQUFPLEVBQUUsRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztJQUN6RCxDQUFDO0NBRUY7QUFqSUQsOEJBaUlDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgSW5qZWN0YWJsZUlkLFxuICBQcm92aWRlcixcbiAgU3RvcmVQcm92aWRlcixcbiAgQ2xhc3NQcm92aWRlcixcbiAgRmFjdG9yeVByb3ZpZGVyLFxuICBWYWx1ZVByb3ZpZGVyLFxuICBEZXBlbmRlbmN5LFxuICBJbmplY3RhYmxlLFxuICBGYWN0b3J5XG59IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgU3RvcmUgfSBmcm9tICcuL3N0b3JlJztcbmltcG9ydCB7IE1pc3NpbmdQcm92aWRlckVycm9yLCBSZWN1cnNpdmVQcm92aWRlckVycm9yIH0gZnJvbSAnLi9lcnJvcnMnO1xuXG5leHBvcnQgY2xhc3MgQ29udGFpbmVyIHtcblxuICAvKipcbiAgICogUmVnaXN0ZXIgbmV3IG9yIHJlcGxhY2UgcHJvdmlkZXJzXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQHBhcmFtIHtQcm92aWRlcltdfSBwcm92aWRlcnNcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgcHJvdmlkZShwcm92aWRlcnM6IFByb3ZpZGVyW10pIHtcbiAgICBwcm92aWRlcnNcbiAgICAgIC5maWx0ZXIoKF9wcm92aWRlcjogQ2xhc3NQcm92aWRlcikgPT4gX3Byb3ZpZGVyLnVzZUNsYXNzKVxuICAgICAgLmZvckVhY2goKF9wcm92aWRlcjogQ2xhc3NQcm92aWRlcikgPT4gdGhpcy5yZWdpc3RlckNsYXNzUHJvdmlkZXIoX3Byb3ZpZGVyKSk7XG5cbiAgICBwcm92aWRlcnNcbiAgICAgIC5maWx0ZXIoKF9wcm92aWRlcjogRmFjdG9yeVByb3ZpZGVyKSA9PiBfcHJvdmlkZXIudXNlRmFjdG9yeSlcbiAgICAgIC5mb3JFYWNoKChfcHJvdmlkZXI6IEZhY3RvcnlQcm92aWRlcikgPT4gdGhpcy5yZWdpc3RlckZhY3RvcnlQcm92aWRlcihfcHJvdmlkZXIpKTtcblxuICAgIHByb3ZpZGVyc1xuICAgICAgLmZpbHRlcigoX3Byb3ZpZGVyOiBWYWx1ZVByb3ZpZGVyKSA9PiBfcHJvdmlkZXIudXNlVmFsdWUpXG4gICAgICAuZm9yRWFjaCgoX3Byb3ZpZGVyOiBWYWx1ZVByb3ZpZGVyKSA9PiB0aGlzLnJlZ2lzdGVyVmFsdWVQcm92aWRlcihfcHJvdmlkZXIpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgaW5zdGFuY2Ugb2YgaW5qZWN0YWJsZVxuICAgKlxuICAgKiBAdGVtcGxhdGUgVFxuICAgKiBAcGFyYW0ge0luamVjdGFibGV9IGluamVjdGFibGVcbiAgICogQHJldHVybnMge1R9XG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGdldDxUPihpbmplY3RhYmxlOiBJbmplY3RhYmxlKTogVCB7XG4gICAgY29uc3QgcHJvdmlkZXI6IFN0b3JlUHJvdmlkZXIgPSBTdG9yZS5maW5kUHJvdmlkZXIoaW5qZWN0YWJsZSk7XG5cbiAgICBpZiAocHJvdmlkZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IE1pc3NpbmdQcm92aWRlckVycm9yKGluamVjdGFibGUpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnJlc29sdmVQcm92aWRlcihwcm92aWRlcilcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXNvbHZlIHByb3ZpZGVyXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7U3RvcmVQcm92aWRlcn0gcHJvdmlkZXJcbiAgICogQHBhcmFtIHtTdG9yZVByb3ZpZGVyW119IFtyZXF1ZXN0ZXJzID0gW11dIHByb3ZpZGVyLCB0aGF0IGluaXRpYXRlZCBkaVxuICAgKiBAcmV0dXJucyB7Kn1cbiAgICovXG4gIHByaXZhdGUgc3RhdGljIHJlc29sdmVQcm92aWRlcihwcm92aWRlcjogU3RvcmVQcm92aWRlciwgcmVxdWVzdGVyczogU3RvcmVQcm92aWRlcltdID0gW10pOiBhbnkge1xuICAgIGlmIChwcm92aWRlci52YWx1ZSkge1xuICAgICAgcmV0dXJuIHByb3ZpZGVyLnZhbHVlO1xuICAgIH1cblxuICAgIHJlcXVlc3RlcnMucHVzaChwcm92aWRlcik7XG5cbiAgICBjb25zdCBkZXBzID0gcHJvdmlkZXJcbiAgICAgIC5kZXBzLm1hcCgoZGVwOiBEZXBlbmRlbmN5KSA9PiB7XG4gICAgICAgIGNvbnN0IHJlcXVlc3RlclByb3ZpZGVyOiBTdG9yZVByb3ZpZGVyID1cbiAgICAgICAgICByZXF1ZXN0ZXJzLmZpbmQoKHJlcXVlc3RlcjogU3RvcmVQcm92aWRlcikgPT4gcmVxdWVzdGVyLmlkID09PSBkZXAuaWQpO1xuXG4gICAgICAgIGlmIChyZXF1ZXN0ZXJQcm92aWRlcikge1xuICAgICAgICAgIHRocm93IG5ldyBSZWN1cnNpdmVQcm92aWRlckVycm9yKHJlcXVlc3RlcnMsIHJlcXVlc3RlclByb3ZpZGVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGRlcFNlcnZpY2U6IFN0b3JlUHJvdmlkZXIgPSBTdG9yZS5maW5kUHJvdmlkZXIoZGVwLmlkKTtcblxuICAgICAgICBpZiAoIWRlcFNlcnZpY2UgJiYgIWRlcC5vcHRpb25hbCkge1xuICAgICAgICAgIHRocm93IG5ldyBNaXNzaW5nUHJvdmlkZXJFcnJvcihwcm92aWRlciwgZGVwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghZGVwU2VydmljZSAmJiBkZXAub3B0aW9uYWwpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLnJlc29sdmVQcm92aWRlcihkZXBTZXJ2aWNlLCByZXF1ZXN0ZXJzKTtcbiAgICAgIH0pO1xuXG4gICAgcHJvdmlkZXIudmFsdWUgPSBwcm92aWRlci5mYWN0b3J5ID9cbiAgICAgIHByb3ZpZGVyLmZhY3RvcnkoLi4uZGVwcykgOiBuZXcgcHJvdmlkZXIudHlwZSguLi5kZXBzKTtcblxuICAgIHJldHVybiBwcm92aWRlci52YWx1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWdpc3RlciBjbGFzcyBwcm92aWRlclxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAc3RhdGljXG4gICAqIEBwYXJhbSB7Q2xhc3NQcm92aWRlcn0gcHJvdmlkZXJcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIHJlZ2lzdGVyQ2xhc3NQcm92aWRlcihwcm92aWRlcjogQ2xhc3NQcm92aWRlcik6IHZvaWQge1xuICAgIGNvbnN0IGlkOiBJbmplY3RhYmxlSWQgPSBTdG9yZS5wcm92aWRlcklkKHByb3ZpZGVyLnByb3ZpZGUpO1xuICAgIGNvbnN0IGNsYXNzUHJvdmlkZXI6IFN0b3JlUHJvdmlkZXIgPSBTdG9yZS5maW5kUHJvdmlkZXIocHJvdmlkZXIudXNlQ2xhc3MpO1xuICAgIGNvbnN0IGRlcHM6IERlcGVuZGVuY3lbXSA9IGNsYXNzUHJvdmlkZXIgPyBjbGFzc1Byb3ZpZGVyLmRlcHMgOiAocHJvdmlkZXIuZGVwcyB8fCBbXSlcbiAgICAgIC5tYXAoKGRlcDogSW5qZWN0YWJsZSkgPT4gKHsgaWQ6IFN0b3JlLnByb3ZpZGVySWQoZGVwKSB9KSk7XG5cbiAgICBTdG9yZS5yZXBsYWNlUHJvdmlkZXIocHJvdmlkZXIucHJvdmlkZSwgeyBpZCwgZGVwcywgdHlwZTogcHJvdmlkZXIudXNlQ2xhc3MgfSk7XG4gIH1cblxuICAvKipcbiAgICogUmVnaXN0ZXIgZmFjdG9yeSBwcm92aWRlclxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAc3RhdGljXG4gICAqIEBwYXJhbSB7RmFjdG9yeVByb3ZpZGVyfSBwcm92aWRlclxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgcmVnaXN0ZXJGYWN0b3J5UHJvdmlkZXIocHJvdmlkZXI6IEZhY3RvcnlQcm92aWRlcik6IHZvaWQge1xuICAgIGNvbnN0IGlkOiBJbmplY3RhYmxlSWQgPSBTdG9yZS5wcm92aWRlcklkKHByb3ZpZGVyLnByb3ZpZGUpO1xuICAgIGNvbnN0IGZhY3Rvcnk6IEZhY3RvcnkgPSBwcm92aWRlci51c2VGYWN0b3J5O1xuICAgIGNvbnN0IGRlcHM6IERlcGVuZGVuY3lbXSA9IChwcm92aWRlci5kZXBzIHx8IFtdKVxuICAgICAgLm1hcCgoZGVwOiBJbmplY3RhYmxlKSA9PiAoeyBpZDogU3RvcmUucHJvdmlkZXJJZChkZXApIH0pKTtcblxuICAgIFN0b3JlLnJlcGxhY2VQcm92aWRlcihwcm92aWRlci5wcm92aWRlLCB7IGlkLCBmYWN0b3J5LCBkZXBzIH0pXG4gIH1cblxuICAvKipcbiAgICogUmVnaXN0ZXIgdmFsdWUgcHJvdmlkZXJcbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHN0YXRpY1xuICAgKiBAcGFyYW0ge1ZhbHVlUHJvdmlkZXJ9IHByb3ZpZGVyXG4gICAqIEBtZW1iZXJvZiBDb250YWluZXJcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIHJlZ2lzdGVyVmFsdWVQcm92aWRlcihwcm92aWRlcjogVmFsdWVQcm92aWRlcik6IHZvaWQge1xuICAgIGNvbnN0IGlkOiBJbmplY3RhYmxlSWQgPSBTdG9yZS5wcm92aWRlcklkKHByb3ZpZGVyLnByb3ZpZGUpO1xuICAgIGNvbnN0IHZhbHVlOiBhbnkgPSBwcm92aWRlci51c2VWYWx1ZTtcblxuICAgIFN0b3JlLnJlcGxhY2VQcm92aWRlcihwcm92aWRlci5wcm92aWRlLCB7IGlkLCB2YWx1ZSB9KTtcbiAgfVxuXG59XG4iXX0=